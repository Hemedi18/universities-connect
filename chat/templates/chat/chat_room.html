{% extends 'business/base.html' %}

{% block title %}Chat with {{ other_user.username }} - U-Connect{% endblock %}

{% block content %}
<div class="chat-room-container chat-room-container-override chat-room-height-mobile" data-user-id="{{ user.id }}" data-conversation-id="{{ conversation.id }}">
    <div class="chat-room-header">
        <a href="{% url 'chat:inbox' %}" class="back-btn"><i class="bi bi-arrow-left"></i></a>
        <div class="chat-user-info">
            <span class="chat-username">{{ other_user.first_name|default:other_user.username }}</span>
        </div>
    </div>

    <div class="messages-container" id="messagesContainer" data-user-id="{{ user.id }}" data-conversation-id="{{ conversation.id }}" data-url="{% url 'chat:get_messages' conversation.id %}">
        {% for message in messages %}
        <div class="message-bubble {% if message.sender == user %}sent{% else %}received{% endif %}" data-id="{{ message.id }}">
            <div class="message-content">{{ message.content }}</div>
            <div class="message-time">{{ message.timestamp|date:"g:i A" }}</div>
        </div>
        {% empty %}
        <p class="chat-empty-text">No messages yet. Say hi!</p>
        {% endfor %}
    </div>

    <div class="chat-input-area">
        <form method="post" class="chat-input-form">
            {% csrf_token %}
            {{ form.content }}
            <button type="submit" class="btn-send"><i class="bi bi-send-fill"></i></button>
        </form>
    </div>
</div>

{% endblock %}